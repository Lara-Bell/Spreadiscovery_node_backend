# My Application

The project is generated by [LoopBack](http://loopback.io).

chmod 400 ./YOUR_KEY_PAIR_NAME.pem

ssh -i "YOUR_KEY_PAIR_NAME.pem" ubuntu @ YOUR_IPv4_LINK

sudo apt-get update && sudo apt-get upgrade -y
install the package maintainer's version

# Nginx
sudo apt-get install nginx -y
sudo systemctl status nginx
sudo systemctl start nginx
sudo systemctl enable nginx

# Node.js
sudo apt-get update
sudo apt-get install build-essential libssl-dev

cd ~
curl -sL https://raw.githubusercontent.com/creationix/nvm/v0.33.5/install.sh -o install_nvm.sh
bash install_nvm.sh
source ~/.profile
nvm install 6.0.0
nvm use 6.0.0
node -v
npm -v

sudo rm /etc/nginx/sites-available/default
sudo nano /etc/nginx/sites-available/default

server {
    listen 80;
    server_name api.spreadiscovery.com www.api.spreadiscovery.com;
    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_redirect off;
     }
}


sudo systemctl reload nginx

# MongoDB
sudo apt-get install mongodb -y
sudo apt-get update -y
sudo service mongodb start
sudo service mongodb status

use my_db_name
db.createUser({
  user: "exampleUser",
  pwd: "changeThisInfo",
  roles: [{ role: "readAnyDatabase", db: "admin" }, "readWrite"]
})
db.auth("exampleUser","changeThisInfo");
exit

sudo nano /etc/mongodb.conf
Uncomment auth=true

# Git Setup
cd ~/.ssh
ssh-keygen
cat id_rsa.pub

cd ~/
git clone REPO_PATH_WITH_SSH

cd ./REPO_NAME
npm install

npm run start:dev

mv config/config.example.js
db: 'mongodb://exampleUser:changeThisInfo@localhost:27017/my_db_name',
db_dev: 'mongodb://exampleUser:changeThisInfo@localhost:27017/my_db_name'
npm run start:dev

# PM2
npm install pm2 -g

pm2 start server.js -- --production
pm2 show server
pm2 stop server

# SSL Setup
cd ~
sudo add-apt-repository ppa:certbot/certbot

sudo apt-get update
sudo apt-get install python-certbot-nginx

sudo ufw status
sudo ufw allow 'Nginx Full'

sudo certbot --nginx -d api.spreadiscovery.com -d www.api.spreadiscovery.com

sudo nginx -t
sudo systemctl reload nginx

sudo crontab -e
15 3 * * * /usr/bin/certbot renew --quiet

cd ~/YOUR_REPO
pm2 start server.js -- --production